@startuml "匹配状态机图"

[*] --> 未匹配
未匹配 --> 匹配请求中: 用户发起匹配请求
匹配请求中 --> 匹配成功: 对方接受匹配
匹配请求中 --> 匹配失败: 对方拒绝匹配
匹配请求中 --> 匹配超时: 超过72小时未回应
匹配成功 --> 正在聊天: 任一方发起聊天
正在聊天 --> 已建立关系: 双方互动频繁
正在聊天 --> 匹配冷却: 7天内无互动
匹配冷却 --> 正在聊天: 任一方重新发起互动
匹配冷却 --> 匹配终止: 30天无互动
匹配失败 --> [*]
匹配超时 --> 未匹配: 系统重置
匹配终止 --> [*]

state 匹配请求中 {
  [*] --> 等待回应
  等待回应 --> 请求已查看: 对方查看请求
  请求已查看 --> 等待决定: 对方考虑中
}

state 正在聊天 {
  [*] --> 初次聊天
  初次聊天 --> 日常交流: 超过10条消息
  日常交流 --> 深度交流: 连续3天有互动
}

@enduml 